name: Monthly Add-on Discovery

on:
  schedule:
    # Run on the 15th of each month at 00:00 UTC
    - cron: '0 0 15 * *'
  workflow_dispatch: # Allow manual trigger

permissions:
  contents: read
  issues: write

jobs:
  discover-addons:
    name: Discover Free Add-ons and Integrations
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v6
      
      - name: Search for HR-related GitHub apps
        id: github-apps
        run: |
          echo "Searching GitHub Marketplace for HR-related apps..."
          
          # This is a placeholder - actual implementation would query GitHub Marketplace API
          # For now, we'll create a curated list based on research
          
          cat > apps-report.md << 'EOF'
          ## GitHub Apps & Integrations for HR Portals
          
          ### Free/Open Source Options Discovered
          
          #### Dependency Management
          - **Dependabot** (Already Enabled âœ…)
            - Automated dependency updates
            - Security vulnerability alerts
            - Free for public and private repos
          
          - **Renovate Bot**
            - Alternative to Dependabot
            - More configuration options
            - Free for open source
          
          #### Code Quality
          - **CodeQL** (Already Enabled âœ…)
            - Security scanning
            - Vulnerability detection
            - Free for public repos
          
          - **SonarCloud**
            - Code quality analysis
            - Technical debt tracking
            - Free for open source projects
          
          - **Codecov**
            - Code coverage reporting
            - PR coverage analysis
            - Free for open source
          
          #### CI/CD & Deployment
          - **GitHub Actions** (Already Using âœ…)
            - Unlimited for public repos
            - 2,000 minutes/month for private repos
          
          #### Documentation
          - **Read the Docs**
            - Auto-build documentation
            - Version hosting
            - Free for open source
          
          - **GitHub Pages** (Available)
            - Static site hosting
            - Free custom domain support
            - Already available in GitHub
          
          #### Project Management
          - **GitHub Projects** (Available)
            - Kanban boards
            - Issue tracking
            - Roadmap planning
            - Free with GitHub
          
          - **ZenHub**
            - Advanced project management
            - Sprint planning
            - Free for open source
          
          #### Communication
          - **Slack Integration**
            - GitHub notifications in Slack
            - PR and issue updates
            - Free tier available
          
          - **Discord Integration**
            - GitHub webhooks
            - Notification bot
            - Free
          
          #### Security
          - **Snyk**
            - Dependency vulnerability scanning
            - Container security
            - Free for open source
          
          - **GitGuardian**
            - Secret scanning
            - Leak prevention
            - Free for public repos
          
          #### Testing
          - **Cypress Dashboard** (if needed)
            - E2E test recordings
            - Test analytics
            - Free tier available
          
          - **BrowserStack** (if needed)
            - Cross-browser testing
            - Free for open source
          
          #### Monitoring (For Production)
          - **UptimeRobot**
            - Uptime monitoring
            - 50 monitors free
            - 5-minute checks
          
          - **Sentry**
            - Error tracking
            - Performance monitoring
            - Free tier: 5K events/month
          
          - **LogRocket**
            - Session replay
            - Performance monitoring
            - Free tier available
          
          #### Backend-Specific
          - **Postgres.app** (Development)
            - Easy PostgreSQL setup
            - Free and open source
          
          - **pgAdmin** (Database Management)
            - PostgreSQL admin tool
            - Free and open source
          
          #### Frontend-Specific
          - **Vercel** (Alternative Deployment)
            - Frontend hosting
            - Free tier with custom domain
            - Excellent for React apps
          
          - **Netlify** (Alternative Deployment)
            - Static site hosting
            - Form handling
            - Free tier available
          
          #### HR-Specific Integrations
          - **Frappe HR** (Open Source)
            - Full HRMS system
            - Attendance, payroll, leave
            - Self-hosted, free
          
          - **OrangeHRM** (Open Source)
            - Employee records
            - Leave management
            - Self-hosted, free
          
          EOF
          
          echo "report_created=true" >> $GITHUB_OUTPUT
      
      - name: Evaluate add-ons for this project
        id: evaluate
        run: |
          cat > evaluation.md << 'EOF'
          ## Add-on Evaluation for HR Portal
          
          ### High Priority (Recommend Implementing)
          
          #### 1. GitHub Projects
          **Value**: Project management and roadmap visibility
          **Fit**: Perfect for solo HR admin to track features and issues
          **Cost**: Free
          **Effort**: Low (built into GitHub)
          **Recommendation**: âœ… Enable immediately
          
          #### 2. UptimeRobot
          **Value**: Monitor portal availability 24/7
          **Fit**: Critical for production HR system
          **Cost**: Free (up to 50 monitors)
          **Effort**: Low (15 minutes setup)
          **Recommendation**: âœ… Implement within 1 month
          
          #### 3. Sentry (Error Tracking)
          **Value**: Catch and report errors automatically
          **Fit**: Helps solo admin identify issues proactively
          **Cost**: Free tier (5K events/month)
          **Effort**: Medium (1-2 hours integration)
          **Recommendation**: âœ… Implement for production
          
          ### Medium Priority (Consider for Future)
          
          #### 4. SonarCloud
          **Value**: Advanced code quality metrics
          **Fit**: Helps maintain code quality over time
          **Cost**: Free for open source
          **Effort**: Medium (configure CI integration)
          **Recommendation**: âš ï¸ Consider if expanding development team
          
          #### 5. Read the Docs
          **Value**: Professional documentation hosting
          **Fit**: Good for extensive documentation
          **Cost**: Free
          **Effort**: Medium (migrate docs, configure)
          **Recommendation**: âš ï¸ Consider when docs exceed 20+ pages
          
          #### 6. Slack/Discord Integration
          **Value**: Real-time GitHub notifications
          **Fit**: Useful if team communicates via Slack/Discord
          **Cost**: Free
          **Effort**: Low (webhook setup)
          **Recommendation**: âš ï¸ Implement if using Slack/Discord
          
          ### Low Priority (Optional)
          
          #### 7. Alternative Deployment Platforms
          **Options**: Vercel, Netlify
          **Value**: Alternative to Azure Static Web Apps
          **Fit**: Could simplify deployment
          **Cost**: Free tier available
          **Effort**: High (migration effort)
          **Recommendation**: â„¹ï¸ Only if issues with current deployment
          
          #### 8. ZenHub
          **Value**: Advanced project management
          **Fit**: Overkill for solo admin
          **Cost**: Free for open source
          **Effort**: Medium
          **Recommendation**: â„¹ï¸ Skip unless team grows >3 people
          
          #### 9. Full HRMS Integration (Frappe, OrangeHRM)
          **Value**: Complete HR management system
          **Fit**: Too complex for current needs
          **Cost**: Free but high self-hosting cost
          **Effort**: Very high (weeks of setup)
          **Recommendation**: â„¹ï¸ Only if expanding significantly beyond current scope
          
          ### Not Recommended
          
          #### Test Automation Tools (BrowserStack, Cypress Dashboard)
          **Reason**: Current project has minimal test infrastructure
          **Recommendation**: âŒ Add tests first, then consider tools
          
          #### Alternative Dependency Managers (Renovate)
          **Reason**: Dependabot already working well
          **Recommendation**: âŒ No need to change
          
          EOF
          
          echo "evaluation_created=true" >> $GITHUB_OUTPUT
      
      - name: Create implementation guides
        id: guides
        run: |
          cat > implementation-guide.md << 'EOF'
          ## Quick Implementation Guides
          
          ### 1. Enable GitHub Projects (5 minutes)
          
          ```bash
          # In GitHub repository:
          1. Go to "Projects" tab
          2. Click "Link a project" or "New project"
          3. Choose template: "Board" or "Table"
          4. Name it: "HR Portal Roadmap"
          5. Add issues to project
          ```
          
          **For Non-Technical Admin**:
          - Go to your repository on GitHub
          - Click "Projects" at the top
          - Click "New project"
          - Choose "Board" view
          - Start organizing your tasks
          
          ### 2. Setup UptimeRobot (15 minutes)
          
          ```bash
          # Steps:
          1. Sign up at https://uptimerobot.com (free)
          2. Click "Add New Monitor"
          3. Type: HTTP(s)
          4. URL: Your portal URL
          5. Name: HR Portal
          6. Monitoring Interval: 5 minutes
          7. Alert Contacts: Your email
          ```
          
          **What You'll Get**:
          - Email alert if portal goes down
          - Uptime percentage reports
          - Response time tracking
          - Public status page (optional)
          
          ### 3. Setup Sentry Error Tracking (1-2 hours)
          
          **Backend (FastAPI)**:
          ```python
          # backend/requirements.txt
          sentry-sdk[fastapi]
          
          # backend/app/main.py
          import sentry_sdk
          
          sentry_sdk.init(
              dsn="your-sentry-dsn",
              environment="production",
              traces_sample_rate=0.1,
          )
          ```
          
          **Frontend (React)**:
          ```bash
          npm install @sentry/react
          ```
          
          ```typescript
          // frontend/src/main.tsx
          import * as Sentry from "@sentry/react";
          
          Sentry.init({
            dsn: "your-sentry-dsn",
            environment: "production",
            tracesSampleRate: 0.1,
          });
          ```
          
          **For Non-Technical Admin**:
          - Request technical support to implement
          - Once set up, you'll receive email alerts for errors
          - Dashboard shows all errors in one place
          - Helps catch issues before users report them
          
          EOF
          
          echo "guides_created=true" >> $GITHUB_OUTPUT
      
      - name: Create monthly add-on discovery issue
        uses: actions/github-script@v7
        with:
          script: |
            const fs = require('fs');
            const appsReport = fs.readFileSync('apps-report.md', 'utf8');
            const evaluation = fs.readFileSync('evaluation.md', 'utf8');
            const guides = fs.readFileSync('implementation-guide.md', 'utf8');
            
            const issue = await github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: 'ðŸ“¦ Monthly Add-on & Integration Discovery - ' + new Date().toISOString().split('T')[0],
              body: `## Monthly Add-on Discovery Report
              
              **Date**: ${new Date().toISOString().split('T')[0]}
              
              This monthly report identifies free and open-source add-ons, integrations, and tools that could enhance the HR Portal.
              
              ---
              
              ${appsReport}
              
              ---
              
              ${evaluation}
              
              ---
              
              ${guides}
              
              ---
              
              ## Decision Framework for Non-Technical Admins
              
              ### Should I implement this add-on?
              
              Ask yourself:
              1. **Will it save me time?** (>30 min/week = yes)
              2. **Will it prevent problems?** (downtime, errors, security)
              3. **Is setup effort reasonable?** (<2 hours = yes)
              4. **Is it free/within budget?** (for startups)
              5. **Does it align with our UAE context?** (compliance, regional)
              
              ### Priority Decision Tree
              
              \`\`\`
              Does it prevent downtime/errors?
                 YES â†’ High Priority (implement now)
                 NO â†“
              
              Does it save >2 hours/week?
                 YES â†’ Medium Priority (implement soon)
                 NO â†“
              
              Is it "nice to have"?
                 YES â†’ Low Priority (consider later)
                 NO â†’ Skip for now
              \`\`\`
              
              ### Recommended Actions This Month
              
              #### Immediate (This Week)
              - [ ] **Enable GitHub Projects** (5 min)
                - Helps organize tasks and roadmap
                - Already available, just needs activation
              
              #### Short-term (This Month)
              - [ ] **Setup UptimeRobot** (15 min)
                - Know immediately if portal goes down
                - Free for up to 50 monitors
                - Critical for production system
              
              #### Medium-term (Next 2-3 Months)
              - [ ] **Implement Sentry** (requires technical help)
                - Catch errors before users report them
                - Free tier sufficient for most needs
                - Improves system reliability
              
              #### Evaluate (Quarterly)
              - [ ] **Review communication integrations** (Slack/Discord)
                - Only if team uses these tools
              - [ ] **Consider documentation hosting** (Read the Docs)
                - Only if docs become extensive
              
              ---
              
              ## For Solo HR Admins in Abu Dhabi
              
              ### Most Valuable for Your Context
              
              1. **UptimeRobot** - Know if portal is down during UAE working hours
              2. **GitHub Projects** - Organize tasks and visualize progress
              3. **Sentry** - Catch errors proactively rather than reactive firefighting
              
              ### Abu Dhabi Specific Considerations
              
              - **Uptime monitoring** is critical - HR doesn't stop for technical issues
              - **Error tracking** helps when you can't have a full-time technical team
              - **Project management** keeps compliance projects organized
              
              ### When to Involve Technical Support
              
              - Setting up monitoring tools (UptimeRobot)
              - Implementing error tracking (Sentry)
              - Evaluating deployment alternatives
              - Configuring complex integrations
              
              ---
              
              ## Cost Summary
              
              ### Currently Enabled (Free)
              - GitHub (base features)
              - GitHub Actions (unlimited public, 2000 min private)
              - Dependabot (free)
              - CodeQL (free for public repos)
              
              ### Recommended Additions (All Free)
              - GitHub Projects (included with GitHub)
              - UptimeRobot (free tier: 50 monitors)
              - Sentry (free tier: 5K events/month)
              
              **Total Additional Cost**: $0/month
              
              ### If Scaling in Future
              - Sentry paid tier: $26/month (40K events)
              - UptimeRobot paid: $7/month (unlimited monitors)
              - Vercel Pro: $20/month (if switching deployment)
              
              ---
              
              ## Next Steps
              
              1. **Review recommendations** above
              2. **Prioritize** based on your current needs
              3. **Implement high-priority** items this month
              4. **Schedule evaluation** for medium-priority items
              5. **Revisit this report** next month to reassess
              
              ---
              
              ## Feedback & Suggestions
              
              Found other useful free tools? Have experience with any of these?
              
              **Comment below** to share:
              - Tools you've successfully implemented
              - Tools that didn't work well
              - Additional free add-ons to consider
              - Regional (UAE/MENA) tools worth evaluating
              
              ---
              
              **Auto-generated by**: Monthly Add-on Discovery workflow  
              **Next report**: ${new Date(Date.now() + 30*24*60*60*1000).toISOString().split('T')[0]}
              `,
              labels: ['enhancement', 'research', 'monthly-summary']
            });
            
            console.log(`Created add-on discovery issue #${issue.data.number}`);
